# Non serve docker exec -it vault /bin/sh

    # Serve essere root #
    vault login root_token

vault auth enable ldap

vault write auth/ldap/config url="ldap://ldap:389" binddn="cn=admin,dc=example,dc=com" bindpass="adminpassword" userdn="dc=example,dc=com" groupdn="dc=example,dc=com" userattr="cn" insecure_tls=true

vault login -method=ldap username="TIZIO" password="TIZIO"

# Set up policies #
    
    # Serve essere root #
    vault login root_token

vault policy write utenti HW345\vault\utenti.hcl
vault policy write amministratori HW345\vault\amministratori.hcl

vault write auth/ldap/groups/utenti policies="utenti"
vault write auth/ldap/groups/amministratori policies="amministratori"

# TEST #
vault login -method=ldap username="TIZIO" password="TIZIO"
vault kv get secret/mysecret # Deve funzionare
vault kv put secret/mysecret value="HelloWorld" # Deve fallire

vault login -method=ldap username="TIZIO_ADMIN" password="TIZIO_ADMIN"
vault kv put secret/mysecret value="HelloWorld" # Deve funzionare